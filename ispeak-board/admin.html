<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.14/index.global.min.js'></script>
	<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
	<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <link rel="stylesheet" href="/src/admin.css">
    <style> 
        .content-tab { display: none; } 
        .content-tab.active { display: block; }
        .board-list li > div:last-child { display: flex; gap: 0.5rem; }
        /* Add a little space between icon and text */
        .tab-btn i, button i { margin-right: 0.5rem; }
    </style>
</head>
<body>
    <div class="dashboard-layout">
        <!-- ===== SIDEBAR NAVIGATION ===== -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3><i class="fa-solid fa-shield-halved"></i> Admin Panel</h3>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="#" id="boards-tab-btn" class="tab-btn active"><i class="fa-solid fa-chalkboard"></i><span>Boards</span></a></li>
					<li><a href="#" id="flashcards-tab-btn" class="tab-btn"><i class="fa-solid fa-layer-group"></i><span>Flashcards</span>
                    <li><a href="#" id="students-tab-btn" class="tab-btn"><i class="fa-solid fa-users"></i><span>Students</span></a></li>
                    <li><a href="#" id="schedule-tab-btn" class="tab-btn"><i class="fa-solid fa-calendar-days"></i><span>Schedule</span></a></li>
                    <li><a href="#" id="lessons-tab-btn" class="tab-btn"><i class="fa-solid fa-person-chalkboard"></i><span>Lessons</span></a></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <button id="logout-btn"><i class="fa-solid fa-right-from-bracket"></i><span>Logout</span></button>
            </div>
        </aside>

        <!-- ===== MAIN CONTENT AREA ===== -->
        <main class="main-content">
            <!-- BOARDS CONTENT -->
            <div id="boards-content" class="content-tab active">
                <h1><i class="fa-solid fa-chalkboard-user"></i> Boards Management</h1>
                <div class="content-grid">
                    <div class="card">
                        <h2>Existing Boards</h2>
                        <ul id="board-list" class="board-list"></ul>
                    </div>
                    <div class="card">
                        <h2><i class="fa-solid fa-plus"></i> Add New Board</h2>
                        <form id="new-board-form">
                            <input type="text" id="new-board-name" placeholder="Enter new board name" required>
                                <button type="submit" class="action-icon-btn add-board-btn" title="Add Board">
									<i class="fa-solid fa-plus"></i>
								</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- STUDENTS CONTENT -->
            <div id="students-content" class="content-tab">
                <h1><i class="fa-solid fa-user-graduate"></i> Registered Students</h1>
                <div class="card">
                    <ul id="student-list" class="board-list"></ul>
                </div>
            </div>
            
            <!-- SCHEDULE CONTENT -->
            <div id="schedule-content" class="content-tab">
                <h1><i class="fa-solid fa-clock"></i> Set Your Availability</h1>
                <div class="card">
                     <div id="calendar-instructions">
                        <p>Click and drag on a time slot to create an available block. Click an existing block to see details or delete it. Drag or resize green blocks to modify them.</p>
                    </div>
                    <div id="calendar"></div>
                </div>
            </div>
            
            <!-- LESSONS CONTENT -->
            <div id="lessons-content" class="content-tab">
                <h1><i class="fa-solid fa-check-double"></i> Finished Lessons</h1>
                <div class="card">
                    <p>This is a list of all booked lessons that have been completed. Click on a lesson to add or edit your notes.</p>
                    <ul id="lesson-list" class="board-list"></ul>
                </div>
            </div>
			
			<div id="flashcards-content" class="content-tab">
				<h1><i class="fa-solid fa-clone"></i> Flashcard Creator</h1>
				
				<!-- The main layout is still a grid, but the structure inside has changed -->
				<div class="flashcard-layout">

					<!-- Column 1: Categories & Sets (This column remains the same) -->
					<div class="flashcard-nav-col">
						<div class="card">
							<h2><i class="fa-solid fa-folder-tree"></i> Categories</h2>
							<ul id="flashcard-category-list" class="fc-list"></ul>
							<form id="new-category-form" class="fc-form">
								<input type="text" id="new-category-name" placeholder="New category name..." required>
								<button type="submit" title="Add Category"><i class="fa-solid fa-plus"></i></button>
							</form>
						</div>
						<div class="card">
							<h2><i class="fa-solid fa-book-bookmark"></i> Sets in&nbsp;<span id="selected-category-name">...</span></h2>
							<ul id="flashcard-set-list" class="fc-list"></ul>
							<form id="new-set-form" class="fc-form" style="display:none;">
								<input type="text" id="new-set-name" placeholder="New set name..." required>
								<button type="submit" title="Add Set"><i class="fa-solid fa-plus"></i></button>
							</form>
						</div>
					</div>

					<!-- NEW: Column 2 is now a single container for the content that will stack vertically -->
					<div class="flashcard-content-area">
						
						<!-- Item 1: The list of cards now sits in its own card, taking the full width of this column -->
						<div class="card">
							<h2><i class="fa-solid fa-list-ul"></i> Cards in&nbsp;<span id="selected-set-name">...</span></h2>
							<p id="flashcard-list-placeholder">Select a set to see its flashcards.</p>
							<ul id="flashcard-list" class="fc-list"></ul>
							<button id="add-new-card-btn" style="display:none; width: 100%; margin-top: 1rem;">
								<i class="fa-solid fa-plus-circle"></i> Create New Card
							</button>
						</div>

						<!-- Item 2: The editor is a separate card below the list, also taking the full width -->
						<div id="flashcard-editor-container" class="card" style="display:none;">
							<h2 id="editor-heading"><i class="fa-solid fa-pen-to-square"></i> Create New Card</h2>
							<form id="flashcard-editor-form">
								<input type="hidden" id="editing-card-id">
								<div class="editor-grid">
									<!-- Front of Card -->
									<div class="editor-side">
										<h3>Front</h3>
										<textarea id="card-front-text" placeholder="Text for the front..."></textarea>
										<img id="front-image-preview" class="image-preview" src="" alt="Front image preview">
										<label>Image (Optional): <input type="file" id="card-front-image" accept="image/*"></label>
									</div>
									<!-- Back of Card -->
									<div class="editor-side">
										<h3>Back</h3>
										<textarea id="card-back-text" placeholder="Text for the back..."></textarea>
										<img id="back-image-preview" class="image-preview" src="" alt="Back image preview">
										<label>Image (Optional): <input type="file" id="card-back-image" accept="image/*"></label>
									</div>
								</div>
								<h3>Definition / Notes (Optional)</h3>
								<textarea id="card-definition" placeholder="Detailed notes or definitions..." rows="3"></textarea>
								<div class="button-group">
									<button type="submit" id="save-card-btn" class="action-btn add-btn">
										<i class="fa-solid fa-save"></i> Save Card
									</button>
									<button type="button" id="cancel-edit-btn" class="action-btn remove-btn" style="background: #a0aec0;">
										Cancel
									</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>			
			
        </main>
    </div>

    <div id="manage-access-modal" class="modal-overlay" style="display:none;">
        <div class="modal-content">
            <h2 id="modal-board-name"><i class="fa-solid fa-user-gear"></i> Manage Access for...</h2>
            <ul id="modal-student-list" class="board-list"></ul>
            <button id="close-modal-btn">Close</button>
        </div>
    </div>

    <div id="event-details-modal" class="modal-overlay" style="display:none;">
        <div class="modal-content">
            <h2 id="modal-event-title">Event Details</h2>
            
            <!-- This section shows for AVAILABLE slots -->
            <div id="available-slot-details">
                <p>You can modify the time range or delete this available slot.</p>
                <div class="form-group">
                    <label for="event-start-time">Start Time</label>
                    <input type="datetime-local" id="event-start-time">
                </div>
                <div class="form-group">
                    <label for="event-end-time">End Time</label>
                    <input type="datetime-local" id="event-end-time">
                </div>
                <div class="button-group">
                    <button id="save-event-btn" class="action-btn add-btn">Save Changes</button>
                    <button id="delete-event-btn" class="action-btn remove-btn">Delete Slot</button>
                </div>
            </div>

            <!-- This section shows for BOOKED slots -->
			<div id="booked-slot-details">
				<p>This lesson has been booked. You can cancel the booking to make the slot available again.</p>
				<p><strong>Booked by:</strong> <span id="booked-by-email">Loading...</span></p>
				
				<div class="meeting-link-container" style="margin-bottom: 1rem;">
					<strong><i class="fa-solid fa-video"></i> Student's Google Meet Link:</strong>
					<p><a id="admin-meeting-link" href="#" target="_blank">Loading...</a></p>
				</div>

				<div class="button-group">
					<button id="cancel-booking-btn" class="action-btn remove-btn">Cancel Booking</button>
				</div>
			</div>

            <button id="close-event-modal-btn">Close</button>
        </div>
    </div>
	
    <div id="student-notes-modal" class="modal-overlay" style="display:none;">
        <div class="modal-content">
            <h2 id="modal-student-name"><i class="fa-solid fa-note-sticky"></i> Notes for...</h2>
            <p>Your notes are private and only visible to other administrators.</p>
            <textarea id="student-notes-textarea" placeholder="Enter lesson notes, student progress, or other reminders here..."></textarea>
            <div class="button-group">
                <button id="save-notes-btn" class="action-btn add-btn"><i class="fa-solid fa-floppy-disk"></i> Save Notes</button>
            </div>
            <button id="close-notes-modal-btn" style="width: 100%; margin-top: 1rem; background: #e2e8f0;">Close</button>
        </div>
    </div>

	<div id="lesson-details-modal" class="modal-overlay" style="display:none;">
		<div class="modal-content">
			<h2 id="modal-lesson-title"><i class="fa-solid fa-book-open-reader"></i> Lesson Details</h2>
			<div id="modal-lesson-info" style="margin-bottom: 1.5rem; color: var(--text-color); border-bottom: 1px solid var(--border-color); padding-bottom: 1rem;">Loading...</div>
			
			<p><strong>Lesson Notes (Visible to Admins):</strong></p>
			<!-- Container for the Rich Text Editor -->
			<div id="quill-editor"></div>

			<div class="button-group">
				<button id="save-lesson-notes-btn" class="action-btn add-btn"><i class="fa-solid fa-save"></i> Save Lesson Notes</button>
			</div>
			<button id="close-lesson-modal-btn" style="width: 100%; margin-top: 1rem; background: #e2e8f0;">Close</button>
		</div>
	</div>

    <script type="module" src="/src/admin.js"></script>
</body>
</html>
